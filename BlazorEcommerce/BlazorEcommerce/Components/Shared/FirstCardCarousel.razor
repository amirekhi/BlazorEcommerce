@using BlazorEcommerce.DTOs.Entities
@using ClassLibrary1.Entities
@rendermode InteractiveServer

<div class="flex flex-col md:ml-20 items-start gap-2 md:px-6 py-8 relative">
    <!-- LEFT: Title + Description -->
       <div class=" text-left px-4">
        <h2 class="text-3xl font-bold text-black mb-1">@Title <span class="text-3xl font-bold text-gray-500">@Description</span></h2>
        
    </div>

    <!-- RIGHT: Carousel -->
    <div class="relative w-full overflow-hidden">
        <button @onclick="ScrollLeft"
                class="absolute left-2 top-1/2 transform -translate-y-1/2 z-30 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition">
            &#10094;
        </button>

        <div @ref="carouselRef"
             class="flex gap-6 overflow-x-auto scroll-smooth py-4 hide-scrollbar  px-6">

            <!-- ✅ Hardcoded Featured Card -->
            <div class="relative min-w-[520px] h-[500px] rounded-2xl overflow-hidden shadow-md hover:shadow-xl transition-shadow bg-white snap-start flex flex-col justify-start p-6 text-black">
                <h2 class="text-3xl font-bold mb-2 z-50">Featured Product</h2>
                <p class="text-md text-gray-600 mb-4 z-50">
                    Explore our exclusive new arrivals and handpicked recommendations.
                </p>

                 <img src="/cat2.jpg"
                     alt="category image"
                     class="absolute inset-0 w-full h-full object-cover opacity-95 group-hover:scale-105 transition-transform duration-500" />

                         
                <button class="text-sm px-5 py-2 bg-black text-white rounded-full hover:bg-gray-800 transition mt-auto z-50">
                    Shop Now
                </button>
            </div>

            <!-- ✅ Dynamic Product Cards -->
            @foreach (var product in Products)
            {
                <a href="/Product/@product.Id" class="no-underline text-inherit"> 
                <div class="relative min-w-[360px] sm:min-w-[360px] md:min-w-[380px] h-[500px] rounded-2xl overflow-hidden shadow-md hover:shadow-xl transition-shadow group  ">
                    <img src="@product.ImageUrl"
                         alt="@product.Name"
                         class="  w-full h-[60%] object-contain opacity-95 group-hover:scale-105 transition-transform duration-500" />

                   

                    <div class="relative z-20 h-[40%] flex flex-col justify-end p-4 text-black">
                        <h2 class="text-[28px] font-semibold mb-1">@product.Name</h2>
                        <p class="text-[17px] text-gray-500 mb-3 max-w-[300px]">
                            @product.Description?.Substring(0, Math.Min(60, product.Description.Length))...
                        </p>
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-bold">$@product.Price</span>
                        </div>
                    </div>
                </div>
                </a>
            }
        </div>

        <button @onclick="ScrollRight"
                class="absolute right-2 top-1/2 transform -translate-y-1/2 z-30 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition">
            &#10095;
        </button>
    </div>
</div>

@code {
    [Parameter]
    public List<ProductDTO> Products { get; set; }

    [Parameter]
    public string Title { get; set; }

    [Parameter]
    public string Description { get; set; }

    private ElementReference carouselRef;

    private async Task ScrollLeft()
    {
        await JS.InvokeVoidAsync("carouselScroll", carouselRef, -1);
    }

    private async Task ScrollRight()
    {
        await JS.InvokeVoidAsync("carouselScroll", carouselRef, 1);
    }

    [Inject]
    private IJSRuntime JS { get; set; }
}
